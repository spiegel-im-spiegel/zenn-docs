---
title: "Go å…¬å¼ã®è„†å¼±æ€§ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ " # è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«
emoji: "ğŸ’®" # ã‚¢ã‚¤ã‚­ãƒ£ãƒƒãƒã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹çµµæ–‡å­—ï¼ˆ1æ–‡å­—ã ã‘ï¼‰
type: "idea" # "tech" : æŠ€è¡“è¨˜äº‹ / "idea" : ã‚¢ã‚¤ãƒ‡ã‚¢è¨˜äº‹
topics: ["go", "programming", "security"] # ã‚¿ã‚°ã€‚["markdown", "rust", "aws"] ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹
published: true # å…¬é–‹è¨­å®šï¼ˆtrue ã§å…¬é–‹ï¼‰
---

## Go Vulnerability Management

Twitter ã® TL ã‚’çœºã‚ã¦ã„ã¦ [Go] å…¬å¼ã®è„†å¼±æ€§ãƒ¬ãƒãƒ¼ãƒˆã®ãƒšãƒ¼ã‚¸ãŒã‚ã‚‹ã“ã¨ã‚’çŸ¥ã‚‹ã€‚

https://pkg.go.dev/vuln/list

ã§ï¼Œã“ã‚Œã«ã¤ã„ã¦

https://twitter.com/spiegel_2007/status/1557187183072935936

ã¨ã‹å‘Ÿã„ãŸã‚‰

https://twitter.com/mattn_jp/status/1557233641356271616

ã¨æƒ…å ±ã‚’é ‚ã„ãŸã€‚ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ ğŸ™‡

[ä»¶ã®ãƒšãƒ¼ã‚¸](https://go.dev/security/vulndb/ "Go Vulnerability Management - The Go Programming Language")ã‚’è¦—ã„ã¦ã¿ã‚‹ã¨ï¼Œã“ã‚“ãªæ„Ÿã˜ã§è„†å¼±æ€§ç®¡ç†ã‚’è¡Œã£ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚

![](https://go.dev/security/vulndb/architecture.svg)
*via â€œ[Go Vulnerability Management - The Go Programming Language](https://go.dev/security/vulndb/)â€*

å„ç•ªå·ã®èª¬æ˜ã¯ä»¥ä¸‹ã€‚

> 1. A **data pipeline** that populates the vulnerability database. Data about new vulnerabilities come directly from Go package maintainers or sources such as MITRE and GitHub. Reports are curated by the Go Security team.
> 1. A **vulnerability database** that stores all information presented by govulncheck and can be consumed by other clients.
> 1. A **client library** ([golang.org/x/vuln/client](https://pkg.go.dev/golang.org/x/vuln/client)), which reads data from the Go vulnerability database. This is also used by pkg.go.dev to surface vulnerabilities.
> 1. A **vulncheck API** ([golang.org/x/vuln/vulncheck](https://pkg.go.dev/golang.org/x/vuln/vulncheck)), which is used to find vulnerabilities affecting Go packages and perform static analysis. This API is made available for clients that do not want to run the govulncheck binary, such as VS Code Go.
> 1. The **govulncheck command** ([golang.org/x/vuln/cmd/govulncheck](https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck), a wrapper around the vulncheck library for use on the command line.
> 1. A **web portal** that presents information about vulnerabilities, hosted at [pkg.go.dev/vuln](https://pkg.go.dev/vuln).

[Go] ã®é™çš„è§£æã‚’ã‚„ã£ã¦ãŠã‚‰ã‚Œã‚‹æ–¹ãªã‚‰ [client library](https://pkg.go.dev/golang.org/x/vuln/client) ã‚„ [vulncheck API](https://pkg.go.dev/golang.org/x/vuln/vulncheck) ã‚ãŸã‚Šã¯èˆˆå‘³ãŒæ¹§ãã®ã§ã¯ãªã„ã‹ã¨æ¨å¯Ÿã™ã‚‹ãŒï¼Œä»Šå›ã¯ãŠæ‰‹è»½ã«ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ»ãƒ„ãƒ¼ãƒ« [govulncheck] ã‚’è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã†ã€‚

## govulncheck ã‚’è©¦ã™

[govulncheck] ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ï¼Œã¾ãš [Go] ã®ãƒ“ãƒ«ãƒ‰ç’°å¢ƒã‚’ç”¨æ„ã—

```
$ go install golang.org/x/vuln/cmd/govulncheck@latest
go: downloading golang.org/x/vuln v0.0.0-20220810233855-e1dd057bf2a3
...
```

ã§ãƒ“ãƒ«ãƒ‰çµæœãŒ $GOPATH/bin ã¾ãŸã¯ $GOBIN ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å‡ºåŠ›ã•ã‚Œã‚‹[^env1]ã€‚ã¨ã‚Šã‚ãˆãš `-h` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤ºã—ã¦ã¿ã‚ˆã†ã€‚

[^env1]: [Go] ã®ç’°å¢ƒå¤‰æ•°ã«ã¤ã„ã¦ã¯ã€Œ[GOPATH ã«(å¯èƒ½ãªé™ã‚Š)ä¾å­˜ã—ãªã„ Go é–‹ç™ºç’°å¢ƒ(Go 1.15 ç‰ˆ)](https://zenn.dev/tennashi/articles/3b87a8d924bc9c43573e)ã€ã‚ãŸã‚Šã‚’å‚è€ƒã«ã©ã†ãã€‚

```
$ govulncheck -h
govulncheck: identify known vulnerabilities by call graph traversal.

Usage:

    govulncheck [flags] {package pattern...}

    govulncheck [flags] {binary path} (if built with Go 1.18 or higher)

Flags:

    -json    Print vulnerability findings in JSON format.

    -html    Generate HTML with the vulnerability findings.

    -tags    Comma-separated list of build tags.

    -tests    Boolean flag indicating if test files should be analyzed too.

govulncheck can be used with either one or more package patterns (i.e. golang.org/x/crypto/...
or ./...) or with a single path to a Go binary. In the latter case module and symbol
information will be extracted from the binary to detect vulnerable symbols.

The environment variable GOVULNDB can be set to a comma-separated list of vulnerability
database URLs, with http://, https://, or file:// protocols. Entries from multiple
databases are merged.
```

ãµã‚€ãµã‚€ã€‚ JSON å½¢å¼ã§ã‚‚å‡ºåŠ›ã§ãã‚‹ã‚“ã ãªã€‚ã•ã£ããè©¦ã—ã¦ã¿ã‚ˆã†ã€‚ã¾ãšã¯æ‰‹å…ƒã® [depm](https://github.com/goark/depm) ã®é–‹ç™ºç’°å¢ƒã§è©¦ã—ã¦ã¿ã‚‹ã€‚

```
$ cd ~/path/to/depm

$ govulncheck ./...
govulncheck is an experimental tool. Share feedback at https://go.dev/s/govulncheck-feedback.

Scanning for dependencies with known vulnerabilities...
No vulnerabilities found.
```

ã‚ˆã—ã€‚å•é¡Œãªã•ãã†ã€‚æ¬¡ã« JSON å½¢å¼ã§å‡ºåŠ›ã—ã¦ã¿ã‚‹ã€‚

```
$ govulncheck -json ./...
{
    "Calls": {
        "Functions": {},
        "Entries": null
    },
    "Imports": {
        "Packages": {},
        "Entries": null
    },
    "Requires": {
        "Modules": {},
        "Entries": null
    },
    "Vulns": null,
    "Modules": [
        {
            "Path": "github.com/BurntSushi/toml",
            "Version": "v1.2.0",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/davecgh/go-spew",
            "Version": "v1.1.1",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/emicklei/dot",
            "Version": "v1.0.0",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/goark/depm",
            "Version": "",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/goark/errs",
            "Version": "v1.1.0",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/goark/gocli",
            "Version": "v0.12.0",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/google/licenseclassifier/v2",
            "Version": "v2.0.0-pre6",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/sergi/go-diff",
            "Version": "v1.2.0",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/spf13/cobra",
            "Version": "v1.5.0",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "github.com/spf13/pflag",
            "Version": "v1.0.5",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "golang.org/x/mod",
            "Version": "v0.6.0-dev.0.20220419223038-86c51ed26bb4",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "golang.org/x/sys",
            "Version": "v0.0.0-20220804214406-8e32c043e418",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "golang.org/x/tools",
            "Version": "v0.1.12",
            "Dir": "",
            "Replace": null
        },
        {
            "Path": "stdlib",
            "Version": "v1.19.0",
            "Dir": "",
            "Replace": null
        }
    ]
}
```

ã‚“ãƒ¼ï¼Ÿ ä¾å­˜é–¢ä¿‚ãŒç©ºã ã‘ã©ã„ã„ã®ã‹ãªï¼Ÿ ã¡ã‚‡ã£ã¨æ€ã„ã¤ã„ã¦ [Go] 1.18 ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ€ã‚¦ãƒ³ã—ã¦è©¦ã—ã¦ã¿ãŸã€‚

```
$ go version
go version go1.18 linux/amd64

$ govulncheck -json ./...
{
    "Calls": {
        "Functions": {},
        "Entries": null
    },
    "Imports": {
        "Packages": {
            "1": {
                "ID": 1,
                "Name": "syscall",
                "Path": "syscall",
                "Module": 1,
                "ImportedBy": [
                    2,
                    3,
                    4,
                    5,
                    7,
                    12,
                    13,
                    35,
                    69,
                    74,
                    81
                ]
            },
            ...
            "9": {
                "ID": 9,
                "Name": "json",
                "Path": "encoding/json",
                "Module": 1,
                "ImportedBy": [
                    10,
                    15,
                    49,
                    61,
                    63,
                    66,
                    67
                ]
            }
        },
        "Entries": [
            14,
            15,
            51,
            58,
            59,
            60,
            61,
            65,
            66,
            67,
            68,
            81,
            82
        ]
    },
    "Requires": {
        "Modules": {
            "1": {
                "ID": 1,
                "Path": "stdlib",
                "Version": "v1.18.0",
                "Replace": 0,
                "RequiredBy": [
                    4,
                    5,
                    7,
                    8,
                    9,
                    11,
                    13,
                    14,
                    2,
                    3,
                    6,
                    10,
                    12
                ]
            },
            ...
            "9": {
                "ID": 9,
                "Path": "github.com/google/licenseclassifier/v2",
                "Version": "v2.0.0-pre6",
                "Replace": 0,
                "RequiredBy": [
                    3
                ]
            }
        },
        "Entries": [
            3
        ]
    },
    "Vulns": null,
    "Modules": [
        ...
    ]
}
```

ï¼ˆã‚ã¾ã‚Šã«é•·ã„ã®é€”ä¸­ç«¯æŠ˜ã£ã¦ã‚‹ãŒã”å®¹èµ¦ï¼‰

å‡ºã‚‹ã¢ã‚ƒã‚“ï¼Œã¡ã‚ƒã‚“ã¨ã€‚ã‚“ãƒ¼ã€‚ã“ã®è¾ºã¯ä»Šå¾Œã®èª²é¡Œã ã‚ã†ã‹ã€‚

ã¨ï¼Œã¨ã«ã‹ãæœ€ä½é™ã¯ä½¿ãˆã‚‹ã‚ˆã†ã ã—ï¼ŒãŠãã‚‰ã CI ã«çµ„ã¿è¾¼ã‚€ã®ã‚‚é›£ã—ããªã„ã ã‚ã†ã€‚ãŠè©¦ã—ã‚ã‚Œã€‚

### gopls ã¨ã®é€£æº

[Go] å…¬å¼ã® Language Server ã§ã‚ã‚‹ [gopls] ã¨ [govulncheck] ãŒé€£æºã§ãã‚‹ã‚‰ã—ã„ã€‚

https://twitter.com/gorilla0513/status/1557699235482861568

æƒ…å ±æ„Ÿè¬ã§ã™ ğŸ™‡

ãŸã¨ãˆã° [VS Code](https://code.visualstudio.com/ "Visual Studio Code - Code Editing. Redefined") ã§ [Go ã®æ‹¡å¼µæ©Ÿèƒ½](https://marketplace.visualstudio.com/items?itemName=golang.Go "Go - Visual Studio Marketplace")ã‚’å°å…¥ã— Language Server ã¨ã—ã¦ [gopls] ã‚’æœ‰åŠ¹ã«ã—ã¦ã„ã‚Œã° setting.json ã§ä»¥ä¸‹ã®é …ç›®ã‚’è¿½åŠ ã™ã‚Œã° [govulncheck] ãŒé€£æºã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ãã†ã ã€‚

```json:setting.json
{
  "gopls": {
    "ui.codelenses": {
      "run_vulncheck_exp": true
    }
  }
}
```

è©¦ã—ã«è‡ªåˆ†ã®ç’°å¢ƒã«å…¥ã‚Œã¦ã¿ãŸã‚“ã ã‘ã©ï¼Œä»Šã®ã¨ã“ã‚è­¦å‘ŠãŒå‡ºã‚‹ã‚ˆã†ãªçŠ¶æ³ã«å‡ºãã‚ã•ãªã„ã®ã§ã¡ã‚ƒã‚“ã¨æ©Ÿèƒ½ã—ã¦ã„ã‚‹ã®ã‹è‡ªä¿¡ãŒãªã„ï¼ˆç¬‘ï¼‰

## RESTFul Web API

ã‚ã‚‰ã‹ã˜ã‚å•é¡Œã®ã‚ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ Go è„†å¼±æ€§ID (GO-2021-1234 ãªã©) ãŒåˆ†ã‹ã£ã¦ã„ã‚Œã°ï¼Œç‰¹ã«ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã‚ãªãã¦ã‚‚ç°¡å˜ãª Web API ã§æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

| Path | Description |
| --- | --- |
| `https://vuln.go.dev/index.json` | List of module paths in the database mapped to its last modified timestamp ([link](https://vuln.go.dev/index.json)). |
| `https://vuln.go.dev/$module.json` | List of vulnerability entries for that module ([example](https://vuln.go.dev/golang.org/x/crypto.json)). |
| `https://vuln.go.dev/ID/index.json` | List of all the vulnerability entries in the database. |
| `https://vuln.go.dev/ID/$vuln.json` | An individual Go vulnerability report. |

ã“ã“ã§ `$module` ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åï¼ˆ`golang.org/x/crypto` ãªã©[^mod1]ï¼‰ã§ `$vuln` ã¯è„†å¼±æ€§IDã‚’æŒ‡ã™ã€‚

[^mod1]: æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã¯ `stdlib` ã§æŒ‡å®šã™ã‚‹ã‚ˆã†ã ã€‚

:::message
ãªãŠï¼Œã“ã®ãƒ‘ã‚¹æ§‹æˆã¯æš«å®šçš„ãªã‚‚ã®ã‚‰ã—ã

> Note that these paths and format are provisional and likely to change until an approved proposal.
*(via â€œ[Go Vulnerability Management - The Go Programming Language](https://go.dev/security/vulndb/)â€)*

ã¨æ³¨æ„æ›¸ããŒã‚ã£ãŸã€‚
:::

ãŸã¨ãˆã° [Go] 1.18.5 ã§ä¿®æ­£ã•ã‚ŒãŸè„†å¼±æ€§ã® ID ã¯ [GO-2022-0537](https://pkg.go.dev/vuln/GO-2022-0537) ãªã®ã§

```
$ curl -L "https://vuln.go.dev/ID/GO-2022-0537.json" | jq .
{
  "id": "GO-2022-0537",
  "published": "2022-08-01T22:21:06Z",
  "modified": "2022-08-01T22:21:06Z",
  "aliases": [
    "CVE-2022-32189"
  ],
  "details": "Decoding big.Float and big.Rat types can panic if the encoded message is\ntoo short, potentially allowing a denial of service.\n",
  "affected": [
    {
      "package": {
        "name": "math/big",
        "ecosystem": "Go"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.17.13"
            },
            {
              "introduced": "1.18.0"
            },
            {
              "fixed": "1.18.5"
            }
          ]
        }
      ],
      "database_specific": {
        "url": "https://pkg.go.dev/vuln/GO-2022-0537"
      },
      "ecosystem_specific": {
        "symbols": [
          "Float.GobDecode",
          "Rat.GobDecode"
        ]
      }
    }
  ],
  "references": [
    {
      "type": "FIX",
      "url": "https://go.dev/cl/417774"
    },
    {
      "type": "FIX",
      "url": "https://go.googlesource.com/go/+/055113ef364337607e3e72ed7d48df67fde6fc66"
    },
    {
      "type": "WEB",
      "url": "https://go.dev/issue/53871"
    },
    {
      "type": "WEB",
      "url": "https://groups.google.com/g/golang-announce/c/YqYYG87xB10"
    }
  ]
}
```

ã¨ã„ã†æ„Ÿã˜ã«æƒ…å ±ã‚’å–ã‚Šå‡ºã›ã‚‹ã€‚

æ­£ç›´ãªè©± CVE ãƒ™ãƒ¼ã‚¹ã®æƒ…å ±ãƒšãƒ¼ã‚¸ã¯æ›´æ–°ãŒé…ãã¦ä½¿ã„å‹æ‰‹ãŒã‚ˆããªã„ã€‚ [Go] å…¬å¼ã§è„†å¼±æ€§IDã‚’æŒ¯ã£ã¦é‹ç”¨ã‚’ã—ã¦ãã‚Œã‚‹ã®ã§ã‚ã‚Œã°ï¼Œä»Šå¾Œã¯ãã¡ã‚‰ã‚’é ¼ã‚Šã«ã™ã‚‹ã“ã¨ã«ã—ã‚ˆã†ã€‚

## å‚è€ƒ

https://zenn.dev/spiegel/articles/20220402-how-go-mitigates-supply-chain-attacks
https://text.baldanders.info/golang/check-for-vulns-in-golang-dependencies/
https://yamdas.hatenablog.com/entry/20220808/open-source-security

ä»¥ä¸‹ã®è¨˜äº‹ã«ä»Šå›ç´¹ä»‹ã—ãŸè„†å¼±æ€§ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦å°‘ã—è§£èª¬ãŒã‚ã‚Šã¾ã™ã€‚

https://gihyo.jp/article/2022/08/tukinami-go-01

ã€Œ[Go Conference mini 2022 Autumn IN SENDAI](https://sendaigo.connpass.com/event/256463/)ã€ã®æœ€åˆã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã§ã™ã€‚

https://docs.google.com/presentation/d/1jtuK52vSPLNxzuSJ8LdPrJ2n1-UyY7bNXW7Irr1GEsA/edit

[Go]: https://go.dev/ "The Go Programming Language"
[govulncheck]: https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck "govulncheck command - golang.org/x/vuln/cmd/govulncheck - Go Packages"
[gopls]: https://pkg.go.dev/golang.org/x/tools/gopls "gopls command - golang.org/x/tools/gopls - Go Packages"
