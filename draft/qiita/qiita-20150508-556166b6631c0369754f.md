---
title: "ã¯ã˜ã‚ã¦ã® Go è¨€èª (on Windows) ãã®4"
emoji: "ğŸ˜€"
type: "tech"
topics: [Go,unicode]
published: false
---
ï¼ˆ[ã“ã‚Œã¾ã§ã®è¨˜äº‹ã®ç›®æ¬¡](http://qiita.com/spiegel-im-spiegel/items/dca0df389df1470bdbfa#%E7%9B%AE%E6%AC%A1)ï¼‰

ä»Šå›ã¯æ–‡å­—åˆ—ã«ã¤ã„ã¦ã€‚

## string ã¨ rune

æ–‡å­—åˆ—ã‚’ç¤ºã™ string ã¯ immutable ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã ãŒï¼Œä¸­èº«ã¯ byte é…åˆ—ã§ã‚ã‚‹ã€‚ã—ãŸãŒã£ã¦

```go:string1.go
package main

import "fmt"

func main() {
	nihongo := "æ—¥æœ¬èª"
	size := len(nihongo)

	fmt.Printf("nihongo = %d bytes : ", size)
	for i := 0; i < size; i++ {
		fmt.Printf("%x ", nihongo[i])
	}
	fmt.Printf("\n")
}
```

ã¨ã™ã‚‹ã¨ä»¥ä¸‹ã®çµæœã«ãªã‚‹ã€‚

```shell
C:>go run string1.go
nihongo = 9 bytes : e6 97 a5 e6 9c ac e8 aa 9e
```

ï¼ˆã¡ãªã¿ã« Go è¨€èªã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ UTF-8 ãŒæ—¢å®šã§ã‚ã‚‹ã€‚ä»–ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ‰±ã†ã«ã¯ä½•ã‚‰ã‹ã®å¤‰æ›ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¿…è¦ã«ãªã‚‹ã€‚æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®å¤‰æ›ã¯è¨€èªã«ä¾ã‚‰ãšç›¸å½“ sensitive ãªåˆ†é‡ãªã®ã§ï¼Œã“ã“ã§ã¯è¸ã¿è¾¼ã¾ãªã„ï¼‰

ï¼ˆstring ãªã‚“ã¦åå‰ãªã®ã«ï¼‰æ–‡å­—å˜ä½ã§æƒ…å ±ã‚’ä¿æŒã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ãŸã‚ï¼Œæœ€åˆã®2æ–‡å­—ã‚’å–ã‚Šå‡ºã™ã¤ã‚‚ã‚Šã§ã†ã£ã‹ã‚Š

```go:string2.go
package main

import "fmt"

func main() {
	nihongo := "æ—¥æœ¬èª"

	fmt.Printf("nihongo = %s\n", nihongo)
	fmt.Printf("nippon = %s\n", nihongo[:2])
}
```

ãªã‚“ã¦ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¨ä»¥ä¸‹ã®çµæœã«ãªã‚‹ã€‚

```shell
C:>go run string2.go
nihongo = æ—¥æœ¬èª
nippon = ï¿½ï¿½
```

æ–‡å­—åˆ—ã‚’æ–‡å­—å˜ä½ã§æ‰±ã†ã«ã¯ rune ã‚’ä½¿ã†ã€‚ã„ã‚„ï¼Œãƒ«ãƒ¼ãƒ³ã£ã¦ã©ã‚“ã ã‘å¨äºŒ... ã‚²ãƒ•ãƒ³ã‚²ãƒ•ãƒ³ã€‚

```go:string3.go
package main

import "fmt"

func main() {
	nihongo := "æ—¥æœ¬èª"
	nihongoRune := []rune(nihongo)
	size := len(nihongoRune)

	fmt.Printf("nihongo = %d characters : ", size)
	for i := 0; i < size; i++ {
		fmt.Printf("%#U ", nihongoRune[i])
	}
	fmt.Printf("\n")
}
```

```shell
C:>go run string3.go
nihongo = 3 characters : U+65E5 'æ—¥' U+672C 'æœ¬' U+8A9E 'èª'
```

ã¾ãŸã¯ï¼Œ string ã«å¯¾ã—ã¦ for range ã‚’ä½¿ã£ã¦ãƒ«ãƒ¼ãƒ—ã‚’å›ã™ã¨æ–‡å­—ï¼ˆruneï¼‰å˜ä½ã§å–å¾—ã§ãã‚‹ã€‚

```go:string3b.go
package main

import "fmt"

func main() {
	nihongo := "æ—¥æœ¬èª"

	for pos, runeValue := range nihongo {
		fmt.Printf("%#U starts at byte position %d\n", runeValue, pos)
	}
}
```

```shell
C:>go run string3b.go
U+65E5 'æ—¥' starts at byte position 0
U+672C 'æœ¬' starts at byte position 3
U+8A9E 'èª' starts at byte position 6
```

rune ã®å®Ÿä½“ã¯ int32 ã§ï¼Œå†…éƒ¨çš„ã«ã¯ Unicodeï¼ˆUTF-32 ç›¸å½“ï¼Ÿï¼‰è¡¨ç¾ã«ãªã£ã¦ã„ã‚‹ã€‚ Go è¨€èªå¼ã§æ›¸ããªã‚‰

```go
type rune int32
```

ã£ã¦æ„Ÿã˜ã ã‚ã†ã‹ã€‚

string ã¨ rune ã¯ç›¸äº’å¤‰æ›ã§ãã‚‹ã®ã§ï¼Œæ–‡å­—åˆ—ã‚’åˆ‡ã‚Šå–ã‚‹å ´åˆã¯

```go:string4.go
package main

import "fmt"

func main() {
	nihongo := "æ—¥æœ¬èª"

	fmt.Printf("nihongo = %s\n", nihongo)
	fmt.Printf("nippon = %s\n", string([]rune(nihongo)[:2]))
}
```

ã®ã‚ˆã†ã« string â†’ []rune â†’ string ã¨å¤‰æ›ã—ã¦ã„ã‘ã°å®‰å…¨ã«å‡¦ç†ã§ãã‚‹ã€‚

```shell
C:>go run string4.go
nihongo = æ—¥æœ¬èª
nippon = æ—¥æœ¬
```

é–¢æ•°åŒ–ã™ã‚‹ãªã‚‰ã“ã‚“ãªæ„Ÿã˜ï¼Ÿ

```go:string4.go
package main

import "fmt"

func main() {
	nihongo := "æ—¥æœ¬èª"

	fmt.Printf("nihongo = %s\n", nihongo)
	fmt.Printf("nippon = %s\n", substring(nihongo, 0, 2))
}

func substring(s string, start, length int) string {
	runes := []rune(s)
	if start >= len(runes) {
		return "";
	} else if start < 0 {
		start = 0
	}
	if length < 0 {
		length = 0
	}
	end := start + length
	if end >= len(runes) {
		return string(runes[start:])
	} else {
		return string(runes[start:end])
	}
}
```

ã‚‚ã†å°‘ã—ç´°ã‹ã„å‡¦ç†ãŒå¿…è¦ãªã‚‰ [unicode/utf8](http://golang.org/pkg/unicode/utf8/) ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†æ‰‹ã‚‚ã‚ã‚‹ã€‚ã¡ãªã¿ã« [strings](http://golang.org/pkg/strings/) ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯å†…éƒ¨ã§ [unicode/utf8](http://golang.org/pkg/unicode/utf8/) ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚ˆã†ã ã€‚

## ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯
- [Strings, bytes, runes and characters in Go - The Go Blog](http://blog.golang.org/strings)
- [Goè¨€èªã®string, runeã®æ­£ä½“ã¨ã¯ï¼Ÿ - golang - The Round](http://knightso.hateblo.jp/entry/2014/06/24/090719)
- [golang - Goã§ãƒãƒ«ãƒãƒã‚¤ãƒˆãŒæ··åœ¨ã—ãŸæ–‡å­—åˆ—ã‚’truncateã™ã‚‹ - Qiita](http://qiita.com/hokaccha/items/3d3f45b5927b4584dbac)
- [golang - Goè¨€èªã§æ–‡å­—ã‚³ãƒ¼ãƒ‰å¤‰æ› - Qiita](http://qiita.com/uchiko/items/1810ddacd23fd4d3c934)

