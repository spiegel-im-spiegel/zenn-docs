---
title: "ã¯ã˜ã‚ã¦ã® Go è¨€èª (on Windows) ãã®9"
emoji: "ğŸ˜€"
type: "tech"
topics: [Go]
published: false
---
ï¼ˆ[ã“ã‚Œã¾ã§ã®è¨˜äº‹ã®ç›®æ¬¡](http://qiita.com/spiegel-im-spiegel/items/98d49ac456485b007a15#%E3%81%AF%E3%81%98%E3%82%81%E3%81%A6%E3%81%AE-go-%E8%A8%80%E8%AA%9E-on-windows)ã€‚åŒãƒšãƒ¼ã‚¸ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚‚å‚è€ƒã«ã©ã†ãï¼‰

ã“ã®ã‚·ãƒªãƒ¼ã‚ºã§ã¯ã—ã°ã‚‰ãã¶ã‚Šã€‚ä»Šå›ã¯ [gb] ã‚’ä½¿ã£ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ãƒ™ãƒ¼ã‚¹ã§ Golang ã®ã‚½ãƒ¼ã‚¹ã‚’ç®¡ç†ã—ã¦ã¿ã‚‹ã€‚

- [gb]
- [constabulary/gb](https://github.com/constabulary/gb)

## gb ã®å°å…¥

[gb] ã®å°å…¥ã¯ `go get` ã‚³ãƒãƒ³ãƒ‰ä¸€ç™ºã§ã‚ã‚‹ï¼ˆ`go get` ã‚³ãƒãƒ³ãƒ‰ã®ä½¿ã„æ–¹ã¯ã€Œ[ãã®3](http://qiita.com/spiegel-im-spiegel/items/a52a47942fd3946bb583)ã€ã‚’ã©ã†ãï¼‰ã€‚

```shell
C:>go get -v github.com/constabulary/gb/...
github.com/constabulary/gb (download)
github.com/constabulary/gb
github.com/constabulary/gb/cmd
github.com/constabulary/gb/cmd/gb-vendor/vendor
github.com/constabulary/gb/cmd/gb
github.com/constabulary/gb/cmd/gb-vendor
```

ç’°å¢ƒå¤‰æ•° `GOPATH` ã§æŒ‡å®šã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã® `bin` ãƒ•ã‚©ãƒ«ãƒ€ã« `gb.exe` ãŠã‚ˆã³ `gb-vendor.exe` ãŒç”Ÿæˆã•ã‚Œã‚‹ã€‚ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã« `PATH` ã‚’é€šã—ã¦ãŠãã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹ç¯‰ã¨ãƒ“ãƒ«ãƒ‰

### ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®é…ç½®

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã‚’ `C:\path\to\project` ã¨ã—ï¼Œã‚½ãƒ¼ã‚¹ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã™ã‚‹ã€‚

```shell
C:\path\to\project>mkdir src\gbdemo
C:\path\to\project>tree . /A
C:\PATH\TO\PROJECT
â””â”€src
    â””â”€gbdemo
```

æ›´ã« `C:\path\to\project\src\gbdemo` ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚½ãƒ¼ã‚¹ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã€‚ä»Šå›ã¯ã€Œ[ãã®6](http://qiita.com/spiegel-im-spiegel/items/404871d2bafd22bdbb90)ã€ã§æœ€å¾Œã«ä½œã£ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æµç”¨ã™ã‚‹ã€‚

```go:gbdemo/main.go
package main

import (
	"flag"
	"fmt"
	"github.com/spiegel-im-spiegel/astrocalc/modjulian"
	"strconv"
	"time"
)

func main() {
	//å¼•æ•°ã®ãƒã‚§ãƒƒã‚¯
	flag.Parse()
	argsStr := flag.Args()
	if len(argsStr) < 3 {
		fmt.Printf("å¹´æœˆæ—¥ã‚’æŒ‡å®šã—ã¦ãã ã•ã„")
		return
	}
	args := make([]int, 3)
	for i := 0; i < 3; i++ {
		num, err := strconv.Atoi(argsStr[i])
		if err != nil {
			if enum, ok := err.(*strconv.NumError); ok {
				switch enum.Err {
				case strconv.ErrRange:
					fmt.Printf("Bad Range Error")
				case strconv.ErrSyntax:
					fmt.Printf("Syntax Error")
				}
			}
			return
		} else {
			args[i] = num
		}
	}
	tm := time.Date(args[0], time.Month(args[1]), args[2], 0, 0, 0, 0, time.UTC)
	fmt.Printf("%v\n", tm)
	fmt.Printf("MJD = %dæ—¥\n", modjulian.DayNumber(tm))
}
```

ã‚ã¨ã¯ `gb build` ã‚³ãƒãƒ³ãƒ‰ã§ãƒ“ãƒ«ãƒ‰ã™ã‚Œã°ã„ã„ã®ã ãŒï¼Œã“ã“ã§ `github.com/spiegel-im-spiegel/astrocalc/modjulian` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒãªã„ã¨ã‚¨ãƒ©ãƒ¼ã‚’åã„ã¦ã—ã¾ã†ã€‚

```shell
C:\path\to\project>gb build
FATAL command "build" failed: failed to resolve import path "gbdemo": cannot find package "github.com/spiegel-im-spiegel/astrocalc/modjulian" in any of:
        C:\Go\src\github.com\spiegel-im-spiegel\astrocalc\modjulian (from $GOROOT)
        C:\path\to\project\src\github.com\spiegel-im-spiegel\astrocalc\modjulian (from $GOPATH)
        C:\path\to\project\vendor\src\github.com\spiegel-im-spiegel\astrocalc\modjulian
```

`GOPATH` ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ãƒ•ã‚©ãƒ«ãƒ€ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ãŠæ°—ã¥ãã ã‚ã†ã‹ã€‚ [gb] ã§ã¯æ—¢å­˜ã® `GOPATH` è¨­å®šã¯ä½¿ã‚ãªã„ã‚ˆã†ã ã€‚

### å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å°å…¥

å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å°å…¥ã™ã‚‹ã«ã¯ `gb vendor fetch` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã€‚

```shell
C:\path\to\project>gb vendor fetch github.com/spiegel-im-spiegel/astrocalc/modjulian
C:\path\to\project>tree . /A
C:\PATH\TO\PROJECT
â”œâ”€src
â”‚  â””â”€gbdemo
â”‚          main.go
â”‚
â””â”€vendor
    â”‚  manifest
    â”‚
    â””â”€src
        â””â”€github.com
            â””â”€spiegel-im-spiegel
                â””â”€astrocalc
                    â””â”€modjulian
                            example_test.go
                            modjulian.go
                            modjulian_test.go
```

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã« `vendor` ãƒ•ã‚©ãƒ«ãƒ€ãŒä½œæˆã•ã‚Œï¼Œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒå±•é–‹ã§ãã¦ã„ã‚‹ã®ãŒãŠåˆ†ã‹ã‚Šã ã‚ã†ã‹ã€‚ã¡ãªã¿ã«ä»Šå› `gb vendor fetch` ã§å–å¾—ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ [GitHub] ã®ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰å–ã£ã¦ããŸã‚‚ã®ã ãŒï¼Œ clone ã•ã‚ŒãŸã‚‚ã®ã§ã¯ãªãï¼Œï¼ˆå°‘ãªãã¨ã‚‚è¦‹ãŸç›®ã¯ï¼‰å˜ç´”ã« export ã—ã¦ããŸã‚‚ã®ã®ã‚ˆã†ã§ã‚ã‚‹ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ãƒ•ã‚©ãƒ«ãƒ€å…¨ä½“ã‚’ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç®¡ç†ã™ã‚‹å ´åˆã« `vendor` ãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã«åˆ¥ï¼ˆã‚·ã‚¹ãƒ†ãƒ ï¼‰ã®ãƒªãƒã‚¸ãƒˆãƒªãŒã‚ã‚‹ã¨ç®¡ç†ãŒé¢å€’è‡­ããªã‚‹ã‹ã‚‰ã‹ãªï¼Ÿï¼‰ã€‚

ã¡ãªã¿ã«å¤–éƒ¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã™ã‚‹å ´åˆã¯ `gb vendor update` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã€‚

```shell
C:\path\to\project>gb vendor update github.com/spiegel-im-spiegel/astrocalc/modjulian
```

ã¾ãŸã¯

```shell
C:\path\to\project>gb vendor update -all
```

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰

ã§ã¯ï¼Œã“ã®çŠ¶æ…‹ã§ã‚‚ã†ä¸€å›ãƒ“ãƒ«ãƒ‰ã—ã¦ã¿ã‚‹ã€‚

```shell
C:\path\to\project>gb build
github.com/spiegel-im-spiegel/astrocalc/modjulian
gbdemo

C:\path\to\project>tree . /A
C:\PATH\TO\PROJECT
â”œâ”€bin
â”‚      gbdemo.exe
â”‚
â”œâ”€pkg
â”‚  â””â”€windows
â”‚      â””â”€amd64
â”‚          â””â”€github.com
â”‚              â””â”€spiegel-im-spiegel
â”‚                  â””â”€astrocalc
â”‚                          modjulian.a
â”‚
â”œâ”€src
â”‚  â””â”€gbdemo
â”‚          main.go
â”‚
â””â”€vendor
    â”‚  manifest
    â”‚
    â””â”€src
        â””â”€github.com
            â””â”€spiegel-im-spiegel
                â””â”€astrocalc
                    â””â”€modjulian
                            example_test.go
                            modjulian.go
                            modjulian_test.go

C:\path\to\project>bin\gbdemo 2015 1 1
2015-01-01 00:00:00 +0000 UTC
MJD = 57023æ—¥
```

ä»Šåº¦ã¯ä¸Šæ‰‹ãã„ã£ãŸã‚ˆã†ã ã€‚

ã¡ãªã¿ã« `gb build` ã‚³ãƒãƒ³ãƒ‰ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

```shell
C:\path\to\project>gb help build
usage: gb build [build flags] [packages]

Build compiles the packages named by the import paths, along with their dependencies.

The build flags are

        -f
                ignore cached packages if present, new packages built will overwrite any cached packages.
                This effectively disables incremental compilation.
        -F
                do not cache packages, cached packages will still be used for in cremental compilation.
                -f -F is advised to disable the package caching system.
        -q
                decreases verbosity, effectively raising the output level to ERROR.
                In a successful build, no output will be displayed.
        -R
                sets the base of the project root search path from the current working directory to the value supplied.
                Effectively gb changes working directory to this path before searching for the project root.
        -v
                increases verbosity, effectively lowering the output level from INFO to DEBUG.
        -ldflags 'flag list'
                arguments to pass on each linker invocation.
        -gcflags 'arg list'
                arguments to pass on each go tool compile invocation.

The list flags accept a space-separated list of strings. To embed spaces in an element in the list, surround it with either single or double quotes.

For more about specifying packages, see 'gb help packages'. For more about where packages and binaries are installed, run 'gb help project'.
```

`-ldflags` ã‚„ `-gcflags` ãŒä½¿ãˆã‚‹ã®ã¯ã‚ã‚ŠãŒãŸã„ã‹ãªã€‚


## è¤‡æ•°ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å«ã‚ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†

ã„ãã¤ã‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å«ã‚“ã ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã‚’è¡Œã„ãŸã„å ´åˆã‚‚ã‚ã‚‹ã€‚ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã‚’è€ƒãˆã¦ã¿ã‚‹ã€‚

```shell
C:\path\to\project>tree . /A
C:\PATH\TO\PROJECT
â””â”€src
    â””â”€gbdemo
            main.go

C:\path\to\project>pushd src
C:\path\to\project\src>mkdir github.com\spiegel-im-spiegel
C:\path\to\project\src>cd github.com\spiegel-im-spiegel
C:\path\to\project\src\github.com\spiegel-im-spiegel>git clone git@github.com:spiegel-im-spiegel/astrocalc.git
Cloning into 'astrocalc'...
remote: Counting objects: 35, done.
remote: Total 35 (delta 0), reused 0 (delta 0), pack-reused 34
Unpacking objects: 100% (35/35), done.
Checking connectivity... done.

C:\path\to\project\src\github.com\spiegel-im-spiegel>popd
C:\path\to\project>tree . /A
C:\PATH\TO\PROJECT
â””â”€src
    â”œâ”€gbdemo
    â”‚      main.go
    â”‚
    â””â”€github.com
        â””â”€spiegel-im-spiegel
            â””â”€astrocalc
                â”‚  .gitignore
                â”‚  .travis.yml
                â”‚  LICENSE
                â”‚  README.md
                â”‚
                â””â”€modjulian
                        example_test.go
                        modjulian.go
                        modjulian_test.go
```

ã“ã®çŠ¶æ…‹ã§ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã€‚

```shell
C:\path\to\project>gb build
github.com/spiegel-im-spiegel/astrocalc/modjulian
gbdemo

C:\path\to\project>tree . /A
C:\PATH\TO\PROJECT
â”œâ”€bin
â”‚      gbdemo.exe
â”‚
â”œâ”€pkg
â”‚  â””â”€windows
â”‚      â””â”€amd64
â”‚          â””â”€github.com
â”‚              â””â”€spiegel-im-spiegel
â”‚                  â””â”€astrocalc
â”‚                          modjulian.a
â”‚
â””â”€src
    â”œâ”€gbdemo
    â”‚      main.go
    â”‚
    â””â”€github.com
        â””â”€spiegel-im-spiegel
            â””â”€astrocalc
                â”‚  .gitignore
                â”‚  .travis.yml
                â”‚  LICENSE
                â”‚  README.md
                â”‚
                â””â”€modjulian
                        example_test.go
                        modjulian.go
                        modjulian_test.go

C:\path\to\project>bin\gbdemo 2015 1 1
2015-01-01 00:00:00 +0000 UTC
MJD = 57023æ—¥
```

ã•ã‚‰ã«ãƒ†ã‚¹ãƒˆã‚‚ã§ãã‚‹ï¼ˆãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹ã¯ã€Œ[ãã®7](http://qiita.com/spiegel-im-spiegel/items/64224f22ef17d916dc2d)ã€ã‚’ã©ã†ãï¼‰ã€‚

```shell
C:\path\to\project>gb test
github.com/spiegel-im-spiegel/astrocalc/modjulian
testing: warning: no tests to run
PASS
PASS
```

ï¼ˆãƒ¯ãƒ¼ãƒ‹ãƒ³ã‚°ãŒå‡ºã‚‹ã®ã¯ `gbdemo` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ãƒ†ã‚¹ãƒˆãŒãªã„ãŸã‚ï¼‰

## ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯

- [golang - gbã‚’çŸ¥ã£ãŸã®ã§gojiã‚’ä½¿ã£ãŸWEBã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç®¡ç†ã—ã¦ã¿ãŸ - Qiita](http://qiita.com/shinofara/items/ac0591fef95c2c6e936e)
- [Goè¨€èªã®Dependency/Vendoringã®å•é¡Œã¨ä»Šå¾Œï¼gbã‚ã‚‹ã„ã¯Go1.5 | SOTA](http://deeeet.com/writing/2015/06/26/golang-dependency-vendoring/)

[gb]: http://getgb.io/ "gb - A project based build tool for Go"
[GitHub]: https://github.com/ "GitHub"

