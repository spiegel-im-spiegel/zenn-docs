---
title: "TLS ã«ãŠã‘ã‚‹ Diffie-Hellman éµäº¤æ›ã®è„†å¼±æ€§"
emoji: "ğŸ˜€"
type: "tech"
topics: [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£,è„†å¼±æ€§,TLS]
published: false
---
## è„†å¼±æ€§ã®å†…å®¹

é€šç§° â€œLogjamâ€ æ”»æ’ƒã€‚

ã‹ã¤ã¦é¨’ãŒã‚ŒãŸ FREAK è„†å¼±æ€§ã¨åŒã˜ãï¼Œ TLS çµŒè·¯ä¸Šã«ã€Œä¸­é–“è€…ã€ãŒã„ã‚‹å ´åˆï¼Œ Diffie-Hellmanï¼ˆDHï¼‰éµäº¤æ›ã§ä½¿ã‚ã‚Œã‚‹éµã‚’è¼¸å‡ºç”¨ã®è„†å¼±ãªã‚‚ã®ã«ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã›ã‚‰ã‚Œã‚‹ã€‚ FEAK ã®ã¨ãã¨ã¯ç•°ãªã‚Šï¼Œç‰¹å®šã®å®Ÿè£…ã®è„†å¼±æ€§ã§ã¯ãªã TLS ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®æ¬ é™¥ã€‚

ã¡ãªã¿ã« DH éµäº¤æ›ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯å…¬é–‹éµæš—å·ã®ä¸€ç¨®ã§ï¼ŒãŠäº’ã„ã«ï¼ˆã‚‚ã¡ã‚ã‚“ç¬¬3è€…ã«ã‚‚ï¼‰ç§˜å¯†æƒ…å ±ï¼ˆç§˜å¯†éµï¼‰ã‚’çŸ¥ã‚‰ã‚Œã‚‹ã“ã¨ãªãå®‰å…¨ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³éµã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã¯ã€Œé›¢æ•£å¯¾æ•°å•é¡Œã€ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ ElGamal ã‚„ DSA ã¨åŒç³»çµ±ã®ãƒ­ã‚¸ãƒƒã‚¯ã€‚ãªã®ã§ï¼Œéµé•·ã®ç®¡ç†ã‚‚ ElGamal ã‚„ DSA ã¨åŒç­‰ã®ã‚‚ã®ãŒè¦æ±‚ã•ã‚Œã‚‹ã€‚

æš—å·å¼·åº¦ã¨å„æš—å·æ–¹å¼ã®éµé•·ã®é–¢ä¿‚ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šï¼ˆå˜ä½ã¯ã™ã¹ã¦ bitï¼‰

| Bits of security | Symmetric key algorithms | FFC (DSA, DH)  | IFC (RSA) | ECC (ECDH, ECDSA) |
|-----------------:|:-------------------------|:---------------|:----------|:------------------|
|               80 | 2TDEA                    | L=1024,  N=160 | k=1024    | 160 <= f < 224    |
|              112 | 3TDEA                    | L=2048,  N=224 | k=2048    | 224 <= f < 256    |
|              128 | AES-128                  | L=3072,  N=256 | k=3072    | 256 <= f < 384    |
|              192 | AES-192                  | L=7680,  N=384 | k=7680    | 384 <= f < 512    |
|              256 | AES-256                  | L=15360, N=512 | k=15360   | 512 <= f          |

2030å¹´ä»¥é™ã‚‚å®‰å…¨ã«ä½¿ãˆã‚‹æš—å·å¼·åº¦ã¯ 128bits ä»¥ä¸Šã ã¨è¨€ã‚ã‚Œã¦ã„ã‚‹ã€‚ Logjam æ”»æ’ƒã§ã¯ L=512bits ã«ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã›ã‚‰ã‚Œã‚‹ãŒå…¨ããŠè©±ã«ãªã‚‰ãªã„å¼·åº¦ã ã¨ã„ã†ã“ã¨ãŒåˆ†ã‹ã‚‹ã ã‚ã†ã€‚

æš—å·ã«ã¤ã„ã¦è©³ã—ãã¯æ‹™æ–‡ã€Œ[ã‚ã‹ã‚‹ï¼ OpenPGP æš—å·](http://www.baldanders.info/spiegel/archive/pgpdump/openpgp.shtml#ref)ã€ã®ã€Œ[æš—å·ã«é–¢ã™ã‚‹é›‘å¤šãªè©±](http://www.baldanders.info/spiegel/archive/pgpdump/openpgp.shtml#appendix)ã€ã‚ãŸã‚Šã‚’ã©ã†ãã€‚
ã¾ãŸ [FREAK ã«ã¤ã„ã¦ã¯ Gist ã«ã¾ã¨ã‚ã¦ã„ã‚‹](https://gist.github.com/spiegel-im-spiegel/47f340122c895ccc8bb8)ã®ã§ï¼Œãã¡ã‚‰ã‚‚å‚è€ƒã«ã©ã†ãã€‚

## å½±éŸ¿åº¦

[CVE-2015-1716] ã‚ˆã‚Š

CVSS åŸºæœ¬å€¤ 5.0 (AV:N/AC:L/Au:N/C:P/I:N/A:N)

| åŸºæœ¬è©•ä¾¡åŸºæº–                            | è©•ä¾¡å€¤            |
|----------------------------------------:|:------------------|
| æ”»æ’ƒå…ƒåŒºåˆ†ï¼ˆAVï¼‰                        | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆNï¼‰ |
| æ”»æ’ƒæ¡ä»¶ã®è¤‡é›‘ã•ï¼ˆACï¼‰                  | ä½ï¼ˆLï¼‰           |
| æ”»æ’ƒå‰ã®èªè¨¼è¦å¦ï¼ˆAuï¼‰                  | ä¸è¦ï¼ˆNï¼‰         |
| æƒ…å ±æ¼ãˆã„ã®å¯èƒ½æ€§ï¼ˆæ©Ÿå¯†æ€§ã¸ã®å½±éŸ¿, Cï¼‰ | éƒ¨åˆ†çš„ï¼ˆPï¼‰       |
| æƒ…å ±æ”¹ã–ã‚“ã®å¯èƒ½æ€§ï¼ˆå®Œå…¨æ€§ã¸ã®å½±éŸ¿, Iï¼‰ | ãªã—ï¼ˆNï¼‰         |
| æ¥­å‹™åœæ­¢ã®å¯èƒ½æ€§ï¼ˆå¯ç”¨æ€§ã¸ã®å½±éŸ¿, Aï¼‰   | ãªã—ï¼ˆNï¼‰         |

[CVE-2015-4000] ã‚ˆã‚Š

CVSS åŸºæœ¬å€¤ 4.3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)

| åŸºæœ¬è©•ä¾¡åŸºæº–                            | è©•ä¾¡å€¤            |
|----------------------------------------:|:------------------|
| æ”»æ’ƒå…ƒåŒºåˆ†ï¼ˆAVï¼‰                        | ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆNï¼‰ |
| æ”»æ’ƒæ¡ä»¶ã®è¤‡é›‘ã•ï¼ˆACï¼‰                  | ä¸­ï¼ˆMï¼‰           |
| æ”»æ’ƒå‰ã®èªè¨¼è¦å¦ï¼ˆAuï¼‰                  | ä¸è¦ï¼ˆNï¼‰         |
| æƒ…å ±æ¼ãˆã„ã®å¯èƒ½æ€§ï¼ˆæ©Ÿå¯†æ€§ã¸ã®å½±éŸ¿, Cï¼‰ | ãªã—ï¼ˆNï¼‰         |
| æƒ…å ±æ”¹ã–ã‚“ã®å¯èƒ½æ€§ï¼ˆå®Œå…¨æ€§ã¸ã®å½±éŸ¿, Iï¼‰ | éƒ¨åˆ†çš„ï¼ˆPï¼‰       |
| æ¥­å‹™åœæ­¢ã®å¯èƒ½æ€§ï¼ˆå¯ç”¨æ€§ã¸ã®å½±éŸ¿, Aï¼‰   | ãªã—ï¼ˆNï¼‰         |

CVSS ã«ã¤ã„ã¦ã¯[ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸](http://www.baldanders.info/spiegel/archive/cvss/cvss2.html)ã‚’å‚ç…§ã®ã“ã¨ã€‚

[CVE-2015-1716]: https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-1716
[CVE-2015-4000]: https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-4000

## å½±éŸ¿ã‚’å—ã‘ã‚‹å®Ÿè£…

- Microsoft : å½±éŸ¿ã‚ã‚Šã€‚ [MS15-055] ã§ä¿®æ­£æ¸ˆã¿
- OpenSSL è¦å®šã§è¼¸å‡ºã‚°ãƒ¬ãƒ¼ãƒ‰æš—å·ã¯ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã®ã§ï¼Œå®Ÿè³ªçš„ã«ã¯å¤§ä¸ˆå¤«ï¼Ÿ : [Logjam, FREAK and Upcoming Changes in OpenSSL - OpenSSL Blog](https://www.openssl.org/blog/blog/2015/05/20/logjam-freak-upcoming-changes/)
    - [è„†å¼±æ€§ã‚’ä¿®æ­£ã—ãŸã€ŒOpenSSLã€ã®æœ€æ–°ç‰ˆãŒå…¬é–‹ã€â€œLogjamâ€è„†å¼±æ€§ã®ä¿®æ­£ã‚‚ - çª“ã®æœ](http://www.forest.impress.co.jp/docs/news/20150615_706966.html)

> ã¾ãŸã€ã€ŒOpenSSLã€v1.0.2b/v1.0.1nã«é–¢ã—ã¦ã¯ã€TLSé€šä¿¡ã§æš—å·å¼·åº¦ã®å¼±ã„è¼¸å‡ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®æš—å·ã¸æ„å›³ã›ãšãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã¦ã—ã¾ã†â€œLogjamâ€è„†å¼±æ€§ï¼ˆCVE-2015-4000ï¼‰ã‚‚ä¿®æ­£ã•ã‚Œã¦ã„ã‚‹ã€‚ 

- Apple Safari : å½±éŸ¿ã‚ã‚Šã€‚ä¿®æ­£ç‰ˆãªã—
- Android : å½±éŸ¿ã‚ã‚Šã€‚ä¿®æ­£ç‰ˆãªã—
- Google Chrome : å½±éŸ¿ã‚ã‚Šã€‚ä¿®æ­£ç‰ˆãªã—ã€‚ Chrome 43 ã§ã‚‚è§£æ¶ˆã•ã‚Œã¦ãªã„ã‚‰ã—ã„
- Mozilla Firefox : å½±éŸ¿ã‚ã‚Šã€‚ä¿®æ­£ç‰ˆãªã—
    - [è„†å¼±æ€§ Logjam Attackå¯¾ç­– for Firefox - ãµã‚‰ã£ã¨ æ°—ã®å‘ãã¾ã¾ã«](http://datyotosanpo.blog.fc2.com/blog-entry-69.html) : Firefox ãŒæ›´æ–°ã•ã‚Œã‚‹ã¾ã§ DH(E) ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹
- OpenVPN : å½±éŸ¿ã¯ã»ã¨ã‚“ã©ãªã„ï¼Ÿ
    - [TLSã®è„†å¼±æ€§ã€ŒLogjamã€ã®OpenVPNã¸ã®å½±éŸ¿ Â« yamata::memo](http://yamatamemo.blogspot.jp/2015/05/tlslogjamopenvpn.html)
        - OpenVPNã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚ã« openssl dhparam ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦OpenVPNå°‚ç”¨ã®DHãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¦ã„ã‚‹ãŸã‚ã€DHãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åˆ¥å€‹ã«ç”Ÿæˆã—ãªã„ä½¿ç”¨æ–¹æ³•ã‚ˆã‚Šã¯å®‰å…¨ã¨ã„ãˆã‚‹ã€‚
        - openssl dhparam ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œæ™‚ã«éµé•·ã‚’ 2048ãƒ“ãƒƒãƒˆä»¥ä¸Šã«ã—ã¦ã„ã‚Œã°å®‰å…¨ã€‚1024ãƒ“ãƒƒãƒˆã®å ´åˆã¯æ”»æ’ƒã•ã‚Œã‚‹å¯èƒ½æ€§ã¯å¦å®šã§ããªã„ãŒã€ãã‚Œã§ã‚‚ç°¡å˜ã§ã¯ãªã„ã€‚
        - TLS-AuthãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚Œã°ã“ã®ç¨®ã®TLSã®ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰æ”»æ’ƒã¯å›é¿ã§ãã‚‹ã€‚
- OpenSSH : å½±éŸ¿ã‚ã‚Šã€‚ [On OpenSSH and Logjam â€“ Technology & Policy â€“ Jethro Beekman](https://jbeekman.nl/blog/2015/05/ssh-logjam/)

- [Logjam: PFS Deployment Guide](https://weakdh.org/sysadmin.html) : ã‚µãƒ¼ãƒå´ã§ã®å›é¿ä¾‹

[MS15-055]: https://technet.microsoft.com/library/security/MS15-055 "ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æƒ…å ± MS15-055 - é‡è¦"

## å½±éŸ¿ã®æœ‰ç„¡ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•

ãƒ–ãƒ©ã‚¦ã‚¶ã§ â€œ[The Logjam Attack](https://weakdh.org/)â€ ã®ã‚µã‚¤ãƒˆã‚’è¨ªã‚Œã‚‹ã¨è‡ªå‹•çš„ã«åˆ¤å®šã—ã¦ãã‚Œã‚‹ã€‚

> Warning! Your web browser is vulnerable to Logjam and can be tricked into using weak encryption. You should update your browser.

ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã¨å½±éŸ¿ã‚’å—ã‘ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚

ã‚µãƒ¼ãƒå´ã¯ â€œ[Guide to Deploying Diffie-Hellman for TLS](https://weakdh.org/sysadmin.html)â€ ã®ãƒšãƒ¼ã‚¸ã«ã‚ã‚‹ â€œServer Testâ€ ã§ç¢ºèªã§ãã‚‹ã€‚

## å‚è€ƒãƒšãƒ¼ã‚¸

- [Logjam TLS Attack](https://weakdh.org/logjam.html)
- [Logjam: How Diffie-Hellman Fails in Practice](https://weakdh.org/)
    - [Imperfect Forward Secrecy: How Diffie-Hellman Fails in Practice](https://weakdh.org/imperfect-forward-secrecy.pdf) (PDF)

- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ›ãƒ¼ãƒ« memo ã®è¨˜äº‹](http://www.st.ryukoku.ac.jp/~kjm/security/memo/2015/05.html#20150521_Logjam)
- [Logjam Attackã«ã¤ã„ã¦ã¾ã¨ã‚ã¦ã¿ãŸ - piyolog](http://d.hatena.ne.jp/Kango/20150521/1432219012)
- [The Logjam (and Another) Vulnerability against Diffie-Hellman Key Exchange - Schneier on Security](https://www.schneier.com/blog/archives/2015/05/the_logjam_and_.html)
- [OpenSSHç’°å¢ƒã«å¯¾ã™ã‚‹Logjamè„†å¼±æ€§ã®å¯¾å¿œ | NaviPlus Engineers' Blog](http://tech.naviplus.co.jp/2015/05/25/openssh%E7%92%B0%E5%A2%83%E3%81%AB%E5%AF%BE%E3%81%99%E3%82%8Blogjam%E8%84%86%E5%BC%B1%E6%80%A7%E3%81%AE%E5%AF%BE%E5%BF%9C/) : â€œ[On OpenSSH and Logjam](https://jbeekman.nl/blog/2015/05/ssh-logjam/)â€ ã®æ—¥æœ¬èªè§£èª¬
- [Logjam, Part 1: Why the Internet is Broken Again (an Explainer) | Electronic Frontier Foundation](https://www.eff.org/deeplinks/2015/05/logjam-internet-breaks-again)
- [Logjam, Part 2: Did the NSA Know the Internet Was Broken? | Electronic Frontier Foundation](https://www.eff.org/deeplinks/2015/05/logjam-part-2-did-nsa-know-years-internet-was-broken)

